name: Move Issues on Kanban Based on Comments

on:
  issue_comment:
    types:
      - created

jobs:
  move-issues:
    runs-on: ubuntu-latest

    steps:
    # Step 1: Check out the code
    - name: Checkout code
      uses: actions/checkout@v3

    # Step 2: List all projects for debugging
    - name: List projects
      run: gh project list
      env:
        GH_TOKEN: ${{ secrets.aish }}

    # Step 3: Debug Project Information and Fetch Columns
    - name: Debug Project Information and Columns
      run: |
        gh project view PVT_kwHOCtxenM4As1ms --format json --owner Aishwarya187423 | jq '.columns'
      env:
        GH_TOKEN: ${{ secrets.aish }}

    # Step 4: Move issues based on comment content
    - name: Move Issues on Kanban
      uses: alex-page/github-project-automation-plus@v0.6.0
      with:
        repo-token: ${{ secrets.aish }}
        project: "PVT_kwHOCtxenM4As1ms" # Use full project ID
        column: "Done" # Ensure this matches exactly with the column name
        action: update
